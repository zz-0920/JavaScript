# 分析
1. jsx ==> render function ==> 虚拟dom ==> 真实dom

2. 在 虚拟DOM 中，父子节点的关系是通过 children 来表示的，为了让父子节点关联更密切，查找更高效，react 将 虚拟DOM 进而处理成 fiber 结构(链表)，于是在节点处理时，可以高并发

3. 18 版本之前是基于 React Element 递归渲染，计算量过多就容易造成页面卡顿，18 版本之后引入了 fiber 架构，基于 fiber 架构，将递归渲染改成了基于 fiber 链表的迭代渲染，计算量减少，渲染效率提高。主要因为链表是可以打断的，处理到某一个节点时可以停下来处理其他节点。

# fiber 架构
处理某一个节点时，如果发现一段时间之后，还没处理完，就会暂停处理，去处理其他节点，等其他节点处理完了，再回来处理当前节点。 ---- 时间分片机制

- 通过记录 parent，child，sibling 信息，让树变成链表，于是就可以被打断，每次处理一个 fiber 节点，处理每一个 fiber 节点前判断是否带了固定时间间隔，通过这种时间分片手段，处理fiber的过程放到多个任务里面执行，大大减少了页面内容过多的卡顿问题

# diff 算法
react 中 diff 算法是用来比较 fiber 节点的差异的，只会比较同层的节点，不会跨层比较，从而确定哪些节点需要更新，哪些节点不需要更新，从而减少更新的次数，提高渲染效率。
diff 算法的核心是双端比较，即从新旧节点的头和尾开始比较，找到相同的节点，然后将相同的节点移动到新的位置，从而减少更新的次数。
diff 算法的过程如下：
1. 从旧节点的头和新节点的头开始比较，找到相同的节点，将相同的节点移动到新的位置，然后旧节点的头指针后移，新节点的头指针后移
2. 从旧节点的尾和新节点的尾开始比较，找到相同的节点，将相同的节点移动到新的位置，然后旧节点的尾指针前移，新节点的尾指针前移
3. 重复以上步骤，直到旧节点的头指针超过旧节点的尾指针，或者新节点的头指针超过新节点的尾指针
4. 如果旧节点的头指针超过旧节点的尾指针，说明新节点有一些节点没有被比较到，需要创建新的节点
5. 如果新节点的头指针超过新节点的尾指针，说明旧节点有一些节点没有被比较到，需要删除旧的节点

- 1. 判断新老节点类型是否相同，如果类型相同，复用旧节点，只更新节点的属性
- 2. 如果类型不同，且存在新节点，直接创建新节点
- 3. 如果类型不同，且不存在新节点，删除旧节点
- 4. 否则，直接启用旧节点

# MiniReact
1. 借助 tsc 编译 jsx 为 js
2. 设置 tsconfig.json 设置 tsc 在编译时，使用 MiniReact.createElement 方法替换 jsx 方法
3. 得到了 虚拟DOM 树，将 虚拟DOM 树转换成 fiber 链表
