# 大文件上传

## 前端实现
1. **文件读取与分片**：使用 `File` 对象的 `slice()` 方法将大文件切割成固定大小的分片（如 2MB）
2. **分片标识**：为每个分片生成唯一标识（文件MD5 + 分片索引）
3. **格式转换**：将每个分片包装成 `FormData` 格式，包含分片数据和元信息
4. **并发上传**：使用 `Promise.all` 或并发控制上传所有分片
5. **进度跟踪**：监听每个分片的上传进度，计算整体进度
6. **合并请求**：所有分片上传完成后，发送合并请求到后端

## 后端实现
1. **分片接收**：接收前端上传的分片文件，存储到临时目录
2. **分片管理**：记录每个文件的分片上传状态（数据库或Redis）
3. **分片验证**：验证分片的完整性和顺序
4. **文件合并**：接收到合并请求后，按顺序将所有分片合并成完整文件
5. **清理工作**：合并完成后清理临时分片文件

## 断点续传实现
1. **前端状态保存**：在 localStorage 中记录已上传分片信息
2. **续传查询**：重新上传时，先向后端查询已上传的分片列表
3. **跳过已传分片**：只上传未完成的分片
4. **状态同步**：上传完成后更新本地和服务器状态

## 错误处理与重试
1. **网络异常重试**：对上传失败的分片进行自动重试
2. **分片校验**：使用 MD5 校验分片完整性
3. **超时处理**：设置合理的上传超时时间